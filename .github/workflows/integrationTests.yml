name: Integration Tests

on:
  schedule:
  - cron: 0 2 * * 1-5
  workflow_dispatch:

jobs:
  test-Latest:
    runs-on: macos-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: Unit tests
      run: make tests
      continue-on-error: true
    - name: Test macOS
      run: make test-macOS
      continue-on-error: true
    - name: Test iOS
      run: make test-iOS
      continue-on-error: true
    - name: Test tvOS
      run: make test-tvOS
      continue-on-error: true
  test-12-4:
    runs-on: macos-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: 12.4
    - name: Unit tests
      run: make tests
      continue-on-error: true
    - name: Test macOS
      run: make test-macOS
      continue-on-error: true
    - name: Test iOS
      run: make test-iOS
      continue-on-error: true
    - name: Test tvOS
      run: make test-tvOS
      continue-on-error: true
  test-11-7:
    runs-on: macos-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: 11.7
    - name: Unit tests
      run: make tests
      continue-on-error: true
    - name: Test macOS
      run: make test-macOS
      continue-on-error: true
    - name: Test iOS
      run: make test-iOS
      continue-on-error: true
    - name: Test tvOS
      run: make test-tvOS
      continue-on-error: true
